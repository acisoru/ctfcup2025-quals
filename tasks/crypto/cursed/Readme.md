# crypto | cursed

## Информация

Чем дольше вы вглядываетесь в этот код, тем дольше он вглядывается в вас.

## Выдать участинкам

Предоставьте зип архив: [public/cursed.zip](public/cursed.zip).


## Решение

Есть два числа:

- `N = p^2 * q^2`
- `R = N * r * s`

Есть `B[i]` — матрицы размера `n x n`, есть `secret[i]` — биты флага.

Особым образом создётся матрица `M = sum(secret[i] * B[i])`, такая что её элементы кратны `p` и `q`, это делается с помощью КТО.

Мы вычисляем матрицу `E` как нечто вроде `E = e^M`, но в конечном поле, при помощи укороченного ряда Тейлора. 

Участникам выдаём `R`, `E`, `B[i]` и число `p`. Все матрицы вычислялись над `N`, но выдаются над `R`, чтобы замаскировать модуль.

Краткое решение:

1. Используя тот факт, что матрица `M` имеет `p`-адическую форму, мы можем сделать две вещи:

- восстановить множитель `p * q` и факторизовать `N`, для чего и даётся `p`
- восстановить саму матрицу `M` из `E` при помощи чего-то вроде дискретного логарифма, причём мы вычисляем логарифм не над `Fp` и `Fq`, а опять же в `p`-адиках, что делает логарифм однозначным

2. Когда мы восстановили `M`, мы используем алгоритм `LLL/BKZ` для вычисления `subset sum`. Можно решать по какому-то одному элементу, либо по следу матрицы.

3. Когда восстановили `secret[i]`, получаем флаг


[решение](solve/solver.sage)

## Флаг

ctfcup{m4x1mum_41_slop1ng}
