# Wincrack | Reverse

## Информация

> Всё очень просто и понятно, надо найти флаг. 
>
> Формат флага: `ctfcup{}`


## Деплой

Не требуется

## Выдать участинкам

Файл из директории [public/](public/)

## Описание

Дефолтный crackme под Windows с антидебагом и кастомным алгоритмом шифрованя

## Решение

1. Смотрим TLS и видим там зарегистированный коллбек
2. Изучаем его и видим что он патчит определённый участок в бинаре
3. Патч представляет собой смену фейковой функции проверки флага на реальную
4. В реально функции проверки флаг мы используем для генерации ключей некоторый seed
5. Этот seed лежит внутри PEB и он будет корректный только если приложение было запущено без отладчика
6. Можно запатчить код TLS коллбека так чтобы генерация сида была успешной в любом случае
7. Ревёрсим алгоритм генерации ключа и шифрования и пишем расшифровщик

[Код расшифровки](solve/Source.cpp)

## Флаг

`ctfcup{0h_y0u_able_to_d3crypt_this_s00_its_n00t_s00_h4rd_Huh?}`
