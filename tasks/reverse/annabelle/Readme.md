# reverse | annabelle

## Информация

В заброшенном доме вы находите проклятую куклу. Сможете ли вы узнать ее тайны?

## Выдать участинкам

Предоставьте исполняемый файл: [public/annabelle](public/annabelle).

## Описание

Простая матрешка, на каждом шаге меняющая флаг и проверяющая на совпадение в конце.

## Решение

Исполняемый файл аллоцирует 2 `rwx` буфера. В один записывает флаг и затем код, затем буфера чередуются, т.е. код в одном расшифровывает код и пишет в другой. Каждая ступень тривиально изменяет флаг. В конце флаг проверяется на равенство константе. Для решение нужно сначала расшифровать все стадии (используется `ARC4` с ключем - хешом от кода, что затрудняет отладку). Затем пройтись в обратном порядке и восстановить флаг на каждой стадии.

[решение](solve/solve.py)

## Флаг

ctfcup{c2f85700623151de5b4cfc78}
